Public Class Form1

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Chat.meuip = TextBox1.Text
        Chat.friendip = TextBox2.Text
        Chat.Show()
        Me.Hide()
    End Sub
End Class

------------------------------------------------------------------------------------------------

Imports System.IO
Imports System.Net.Sockets

Public Class Chat
    Public meuip As String
    Public friendip As String

    Dim listener As New TcpListener(6060)
    Dim client As New TcpClient

    Private Sub Chat_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            listener.Start()
        Catch ex As Exception
            MessageBox.Show("Error ao iniciar o servidor!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error)
        End Try
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click

        client = New TcpClient(friendip, 6060)
        Dim sw As New StreamWriter(client.GetStream())
        sw.Write(TextBox2.Text)
        sw.Flush()
        TextBox1.AppendText(TextBox2.Text + vbNewLine)

        TextBox2.Clear()

    End Sub

    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick

        Dim mensagem As String = ""

        If listener.Pending = True Then

            client = listener.AcceptTcpClient
            Dim sr As New StreamReader(client.GetStream())

            While sr.Peek > -1
                mensagem &= Convert.ToChar(sr.Read()).ToString
            End While

            TextBox1.AppendText(mensagem + vbNewLine)

        End If

    End Sub
End Class